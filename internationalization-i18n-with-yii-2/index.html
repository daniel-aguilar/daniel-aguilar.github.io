<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Internationalization (i18n) with Yii 2 | Daniel’s Blog</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Internationalization (i18n) with Yii 2" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Yii 2 provides a very intuitive way to translate your web application, and it makes it easy for both the developers and the translators, by keeping the work that has to be done by both parties nicely separated." />
<meta property="og:description" content="Yii 2 provides a very intuitive way to translate your web application, and it makes it easy for both the developers and the translators, by keeping the work that has to be done by both parties nicely separated." />
<meta property="og:site_name" content="Daniel’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Internationalization (i18n) with Yii 2" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2017-01-15T00:00:00+00:00","datePublished":"2017-01-15T00:00:00+00:00","description":"Yii 2 provides a very intuitive way to translate your web application, and it makes it easy for both the developers and the translators, by keeping the work that has to be done by both parties nicely separated.","headline":"Internationalization (i18n) with Yii 2","mainEntityOfPage":{"@type":"WebPage","@id":"/internationalization-i18n-with-yii-2/"},"url":"/internationalization-i18n-with-yii-2/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Daniel&apos;s Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Daniel&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Internationalization (i18n) with Yii 2</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-01-15T00:00:00+00:00" itemprop="datePublished">Jan 15, 2017
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Yii 2 provides a very intuitive way to translate your web application,
and it makes it easy for both the developers and the translators, by
keeping the work that has to be done by both parties nicely separated.</p>

<p>This guide will focus on translating messages using PHP files.</p>

<h2 id="the-workflow">The Workflow</h2>

<p>A common workflow when translating a Yii application will fit the
following:</p>

<ol>
  <li>
    <p>Write the custom messages in the corresponding views/controllers.
These messages are written in a ‘source’ language (English, by
default).</p>
  </li>
  <li>
    <p>Run the <code class="language-plaintext highlighter-rouge">yii message</code> command that will catch those messages and
prepare a translation document for each language, which consists of a
PHP file that returns an array of key-value pairs.</p>
  </li>
  <li>
    <p>Edit the previously generated file, by writing a translation of each
message (key) to the language of your choice (value).</p>
  </li>
</ol>

<p>This way, all the developer has to worry about is writing the default
messages once, focusing more on his application and functionality, and
tackle the translations later on.</p>

<h2 id="getting-started">Getting Started</h2>

<p>We need to add the <code class="language-plaintext highlighter-rouge">i18n</code> application component to our <code class="language-plaintext highlighter-rouge">config/web.php</code>
configuration file. Here, we’ll define the different translations that
<code class="language-plaintext highlighter-rouge">i18n</code> will process. Here’s an example:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="s1">'i18n'</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">'translations'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'app*'</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'yii\i18n\PhpMessageSource'</span><span class="p">,</span>
            <span class="s1">'sourceLanguage'</span> <span class="o">=&gt;</span> <span class="s1">'en-US'</span><span class="p">,</span>
            <span class="s1">'basePath'</span> <span class="o">=&gt;</span> <span class="s1">'@app/messages'</span><span class="p">,</span>
            <span class="s1">'fileMap'</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s1">'app'</span> <span class="o">=&gt;</span> <span class="s1">'app.php'</span><span class="p">,</span>
                <span class="s1">'app/error'</span> <span class="o">=&gt;</span> <span class="s1">'error.php'</span><span class="p">,</span>
                <span class="s1">'app/other'</span> <span class="o">=&gt;</span> <span class="s1">'other.php'</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">],</span>
    <span class="p">],</span>
<span class="p">],</span></code></pre></figure>

<p>In the above code, the <code class="language-plaintext highlighter-rouge">app*</code> key represents, in layman’s terms, a
‘translation category’. Every message that falls within that category
will receive a certain configuration. The <code class="language-plaintext highlighter-rouge">*</code> character let’s this
configuration catch all categories that start with <code class="language-plaintext highlighter-rouge">app</code>. This allows us
to define sub-categories, such as <code class="language-plaintext highlighter-rouge">app/error</code> or <code class="language-plaintext highlighter-rouge">app/other</code>, thus,
keeping things modular.</p>

<p><code class="language-plaintext highlighter-rouge">class</code> is the PHP class that will handle the translations.
<code class="language-plaintext highlighter-rouge">yii\i18n\PhpMessageSource</code> lets us write them as PHP files.</p>

<p><code class="language-plaintext highlighter-rouge">sourceLanguage</code> indicates what language the messages are written in. In
this case, it’s <code class="language-plaintext highlighter-rouge">en-US</code>, the locale that corresponds to English and
United States.</p>

<p><code class="language-plaintext highlighter-rouge">basePath</code> is the directory where all the translation documents are
located. As you can see, the alias <code class="language-plaintext highlighter-rouge">@app</code> keeps the path short.</p>

<p>Finally, <code class="language-plaintext highlighter-rouge">fileMap</code> associates each sub-category with a translation
document, avoiding long, monolithic files.</p>

<h2 id="writing-the-messages">Writing the Messages</h2>

<p>In order to let Yii know which messages need to be translated, we’ll
have to make use of the <a href="1"><code class="language-plaintext highlighter-rouge">Yii::t()</code></a> method:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="c1">// 'Hello, World!'</span>
<span class="k">echo</span> <span class="nc">Yii</span><span class="o">::</span><span class="nf">t</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="s1">'Hello, World!'</span><span class="p">);</span>

<span class="c1">// 'Something went wrong! (Error: Some error message)'</span>
<span class="k">echo</span> <span class="nc">Yii</span><span class="o">::</span><span class="nf">t</span><span class="p">(</span><span class="s1">'app/error'</span><span class="p">,</span>
    <span class="s1">'Something went wrong! (Error: {error})'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="nv">$exception</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">()]</span>
<span class="p">);</span>

<span class="cm">/*  When count returns 1:   '1 File uploaded successfully'
    Otherwise:              '# Files uploaded successfully' */</span>

<span class="k">echo</span> <span class="nc">Yii</span><span class="o">::</span><span class="nf">t</span><span class="p">(</span><span class="s1">'app/other'</span><span class="p">,</span>
    <span class="s1">'{count} {count, plural, =1{File} other{Files}} uploaded successfully'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'count'</span> <span class="o">=&gt;</span> <span class="nb">count</span><span class="p">(</span><span class="n">attachments</span><span class="p">)]</span>
<span class="p">)</span></code></pre></figure>

<p>The previous examples show just how useful this method is. You can use
parameters to format variable information, and customize the messages as
you like.</p>

<h2 id="the-configuration-file">The Configuration File</h2>

<p>The next step is generating a configuration file for the <code class="language-plaintext highlighter-rouge">yii message</code>
command. The <code class="language-plaintext highlighter-rouge">yii message</code> command is the one in charge of examining the
whole project in search for messages inside the <code class="language-plaintext highlighter-rouge">Yii:t()</code> method, and
prepare a translation document.</p>

<p>Use the <code class="language-plaintext highlighter-rouge">yii message/config</code> command to generate a new configuration
file, passing the necessary options, and a path where to store it.
Here’s an example:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>./yii message/config <span class="nt">--languages</span><span class="o">=</span>es-CR <span class="nt">--sourcePath</span><span class="o">=</span>@app <span class="nt">--messagePath</span><span class="o">=</span>messages config/config.php</code></pre></figure>

<p>This will dynamically generate a <code class="language-plaintext highlighter-rouge">config.php</code> file inside the <code class="language-plaintext highlighter-rouge">config/</code>
directory. Here is how it looks:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">return</span> <span class="p">[</span>
    <span class="s1">'sourcePath'</span> <span class="o">=&gt;</span> <span class="s1">'@app'</span><span class="p">,</span>
    <span class="s1">'messagePath'</span> <span class="o">=&gt;</span> <span class="s1">'messages'</span><span class="p">,</span>
    <span class="s1">'languages'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'es-CR'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'translator'</span> <span class="o">=&gt;</span> <span class="s1">'Yii::t'</span><span class="p">,</span>
    <span class="s1">'sort'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s1">'overwrite'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s1">'removeUnused'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s1">'markUnused'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s1">'except'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'.svn'</span><span class="p">,</span>
        <span class="s1">'.git'</span><span class="p">,</span>
        <span class="s1">'.gitignore'</span><span class="p">,</span>
        <span class="s1">'.gitkeep'</span><span class="p">,</span>
        <span class="s1">'.hgignore'</span><span class="p">,</span>
        <span class="s1">'.hgkeep'</span><span class="p">,</span>
        <span class="s1">'/messages'</span><span class="p">,</span>
        <span class="s1">'/BaseYii.php'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'only'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'*.php'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'php'</span><span class="p">,</span>
<span class="p">];</span>

<span class="cm">/* I have removed the database settings since I'm not using a database to store
translations */</span></code></pre></figure>

<p>Most of these settings are very self-explanatory, but let’s focus on the
most relevant ones: <code class="language-plaintext highlighter-rouge">sourcePath</code>, <code class="language-plaintext highlighter-rouge">messagePath</code>, and <code class="language-plaintext highlighter-rouge">languages</code>:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">sourcePath</code>: Where Yii will start searching for messages. In my
case, it’s the root directory of the application.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">messagePath</code>: The folder where the language directories are stored.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">languages</code>: What languages the application will support. Each
language gets its own dedicated directory, inside <code class="language-plaintext highlighter-rouge">messagePath</code>,
where all the translation files will be located.</p>
  </li>
</ol>

<h2 id="generating-the-translation-files">Generating the Translation Files</h2>

<p>Once the configuration file is ready, it’s time to generate a set of
translation files for each language.</p>

<p>Before doing that, however, it’s crucial that you manually create the
directory you defined in <code class="language-plaintext highlighter-rouge">messagePath</code>, because the command we are about
to execute does not automatically create that folder:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span><span class="nb">mkdir </span>messages</code></pre></figure>

<p>With that out of the way, let’s execute the <code class="language-plaintext highlighter-rouge">yii message</code> command.  You
will need to specify the path where the configuration file is located.
Here’s an example:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>yii message config/config.php</code></pre></figure>

<p>Once the script has finished, you will end up with a directory hierarchy
similar to this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>messages/
└── es-CR
    ├── app
    │   ├── error.php
    │   └── other.php
    ├── app.php
    └── yii.php
</code></pre></div></div>

<p>Where the <code class="language-plaintext highlighter-rouge">app.php</code> corresponds to a general category where most of the
translations will be located, while the sub-directory <code class="language-plaintext highlighter-rouge">app</code> is where the
specific translations go (sub-categories).</p>

<p>Let’s take a look of one of these files:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">return</span> <span class="p">[</span><span class="s1">'{count} {count, plural, =1{File} other{Files}} uploaded successfully'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,];</span></code></pre></figure>

<p>This translation file corresponds to the sub-category app/other, which
only holds one message. As you can see, the source language is paired
with an empty value. This empty value it’s the translation. I’m gonna go
ahead and write a Spanish translation for it. Also, please notice how
the string formatting feature I wrote about early in this guide is still
present here.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">return</span> <span class="p">[</span>
    <span class="s1">'{count} {count, plural, =1{File} other{Files}} uploaded successfully'</span> <span class="o">=&gt;</span>
    <span class="s1">'{count} {count, plural, =1{Archivo subido} other{Archivos subidos}} con exito'</span><span class="p">,</span>
<span class="p">];</span></code></pre></figure>

<p>Now, the application translation is ready. We still need to define a
language in our application:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="nc">Yii</span><span class="o">::</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="n">language</span> <span class="o">=</span> <span class="s1">'es-CR'</span><span class="p">;</span></code></pre></figure>

<p>And just like that, we’ve successfully translated a Yii application to
Spanish.  Now, if we add/edit/delete messages to our code, all we need
to do is call the <code class="language-plaintext highlighter-rouge">yii message</code> command again so it can update the
translation files to reflect the changes. The configuration file can be
set to delete unused translations.</p>

<h2 id="the-result">The Result</h2>

<p>Here are some screenshots displaying how a translated application looks
like:</p>

<h3 id="english">English</h3>

<p><img src="https://i.imgur.com/DXqt3d6.png" alt="example-english" /></p>

<h3 id="spanish">Spanish</h3>

<p><img src="https://i.imgur.com/jPA1te7.png" alt="example-spanish" /></p>

<p>Do notice how Yii does have a Spanish translation for the <code class="language-plaintext highlighter-rouge">GridView</code>
component.  That is because Yii provides more than 30 different language
translations for it’s own components. You can check the list of
available languages inside the <code class="language-plaintext highlighter-rouge">vendor/yiisoft/yii2/messages/</code>
directory.</p>

<h2 id="conclusion">Conclusion</h2>

<p>The Yii 2 Framework makes dealing with translations quite easy, and
provides ways to organize everything in an elegant way. It just takes a
few minutes to configure everything, and after that, it’s just a matter
of executing a simple command, and get on with the translations.</p>

<p>Don’t forget to check the <a href="http://www.yiiframework.com/doc-2.0/guide-tutorial-i18n.html">official Yii 2 guide on
internationalization</a>, which expands even more on this matter. Also,
check out this other great <a href="https://code.tutsplus.com/tutorials/how-to-program-with-yii2-localization-with-i18n--cms-23140">tutorial</a> on the same topic.</p>

<p>I hope that this guide has helped you understand how does i18n works in Yii 2.</p>


  </div><a class="u-url" href="/internationalization-i18n-with-yii-2/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Daniel&#39;s Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <p>There will be code</p>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/daniel-aguilar"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">daniel-aguilar</span></a></li><li><a href="https://www.linkedin.com/in/dan-aguilar"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">dan-aguilar</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>
          This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a><img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt="" style="max-width: 1em;max-height:1em;margin-left: .2em;"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt="" style="max-width: 1em;max-height:1em;margin-left: .2em;">
        </p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
